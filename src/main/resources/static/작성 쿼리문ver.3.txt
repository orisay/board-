CREATE TABLE TB_CATEGORY
(
    CAT_DOMAIN    VARCHAR2(20)     NOT NULL, 
    CAT           VARCHAR2(40)     NOT NULL, 
    BOARD_CNT     NUMBER(18, 0)    DEFAULT 0 NOT NULL,
    RPL_CNT       NUMBER(18, 0)    DEFAULT 0 NOT NULL, 
    MNG           VARCHAR2(48)     NOT NULL, 
    CRT_NM        VARCHAR2(48)     NOT NULL, 
    UP_NM         VARCHAR2(48)     NOT NULL, 
    CRT_TM        DATE             DEFAULT SYSDATE,
    UP_TM         DATE             DEFAULT SYSDATE, 
     PRIMARY KEY (CAT_DOMAIN)
);

CREATE TABLE TB_LOG_CATEGORY
(
    CAT_DOMAIN      NUMBER(18, 0)    NOT NULL, 
    CAT          VARCHAR2(40)     NOT NULL, 
    BOARD_CNT    NUMBER(18, 0)    NOT NULL,
    RPL_CNT      NUMBER(18, 0)    NOT NULL,
    MNG          VARCHAR2(48)     NOT NULL, 
    CRT_NM       VARCHAR2(48)     NOT NULL, 
    UP_NM        VARCHAR2(48)     NOT NULL, 
    CRT_TM       DATE             NOT NULL, 
    UP_TM        DATE              DEFAULT SYSDATE, 
);

CREATE TABLE TB_BOARD
(
    BOARD_NUM     NUMBER(18, 0)    NOT NULL, 
    CAT_DOMAIN    VARCHAR2(20)     NOT NULL, 
    CREATOR       NVARCHAR2(48)    NOT NULL, 
    TTL           VARCHAR2(200)    NOT NULL, 
    CN            CLOB             NOT NULL, 
    VIEW_CNT      NUMBER(18, 0)    DEFAULT 0 NOT NULL, 
    RPL_CNT       NUMBER(18, 0)    DEFAULT 0 NOT NULL, 
    CRT_TM        DATE             DEFAULT SYSDATE,
    UP_TM         DATE             DEFAULT SYSDATE, 
    PW            VARCHAR2(128)    NULL, 
     PRIMARY KEY (BOARD_NUM)
);

CREATE TABLE TB_DEL_BOARD
(
    BOARD_NUM     NUMBER(18, 0)    NOT NULL, 
    CAT_DOMAIN    VARCHAR2(20)     NOT NULL, 
    CREATOR       NVARCHAR2(48)    NOT NULL, 
    TTL           VARCHAR2(200)    NOT NULL, 
    CN            CLOB             NOT NULL, 
    VIEW_CNT      NUMBER(18, 0)   NOT NULL,
    RPL_CNT       NUMBER(18, 0)    NOT NULL, 
    CRT_TM        DATE            NOT NULL, 
    UP_TM         DATE             DEFAULT SYSDATE, 
    PW            VARCHAR2(128)    NULL   
);

CREATE TABLE TB_REPLY
(
    RPL_NUM       NUMBER(18, 0)     NOT NULL, 
    BOARD_NUM     NUMBER(18, 0)     NOT NULL, 
    CREATOR       NVARCHAR2(48)    NOT NULL, 
    RPL_CN        VARCHAR2(1000)    NOT NULL, 
    DEPTH         NUMBER(18, 0)     DEFAULT 1 NOT NULL, 
    CRT_TM        DATE               DEFAULT SYSDATE, 
    UP_TM         DATE               DEFAULT SYSDATE, 
    PARENT_RPL    NUMBER(18, 0)     DEFAULT 0 NOT NULL, 
    PW            VARCHAR2(128)     NULL, 
     PRIMARY KEY (RPL_NUM)
);

CREATE TABLE TB_DEL_REPLY
(
    RPL_NUM       NUMBER(18, 0)     NOT NULL, 
    BOARD_NUM     NUMBER(18, 0)     NOT NULL, 
    CREATOR       NVARCHAR2(48)    NOT NULL,
    RPL_CN        VARCHAR2(1000)    NOT NULL, 
    DEPTH         NUMBER(18, 0)     NOT NULL,  
    CRT_TM        DATE              NOT NULL, 
    UP_TM         DATE              DEFAULT SYSDATE,
    PARENT_RPL    NUMBER(18, 0)     NULL, 
    PW            VARCHAR2(128)     NULL  
);


CREATE TABLE TB_MB
(
    ID        VARCHAR2(13)     NOT NULL, 
    ALS       VARCHAR2(48)     NOT NULL, 
    PW        VARCHAR2(128)    NOT NULL, 
    NM        VARCHAR2(20)     NOT NULL, 
    EMAIL	     VARCHAR2(4)      NOT NULL,
    DOMAIN  VARCHAR2(4)      NOT NULL,	
    ADDR1     VARCHAR2(100)    NOT NULL, 
    ADDR2     VARCHAR2(200)    NOT NULL, 
    PHON1     VARCHAR2(3)      NOT NULL, 
    PHON2     VARCHAR2(4)      NOT NULL, 
    PHON3     VARCHAR2(4)      NOT NULL,	 
    CRT_TM    DATE             DEFAULT SYSDATE, 
    TEL1      VARCHAR2(3)      NULL, 
    TEL2      VARCHAR2(4)      NULL, 
    TEL3      VARCHAR2(4)      NULL, 
     PRIMARY KEY (ID)
);

CREATE TABLE TB_ROLE
(
    ROLE_NUM    NUMBER(1, 0)    NOT NULL CHECK(ROLE_NUM IN(1,2,3,4,5)), 
    ROLE        VARCHAR2(13)     NOT NULL CHECK(ROLE IN('BLOCK','BASIC','SUB_MNG','MNG','ADMIN')),
     PRIMARY KEY (ROLE_NUM)
);

CREATE TABLE MP_MB_ROLE
(
    ROLE_NUM      NUMBER(1, 0)    NOT NULL, 
    ID            VARCHAR2(13)    NOT NULL, 
    CAT_DOMAIN    VARCHAR2(20)    NULL   
);

CREATE TABLE TB_POINT
(
    POINT_NUM    NUMBER(18, 0)    NOT NULL, 
    BOARD_NUM    NUMBER(18, 0)    NOT NULL, 
    ID           VARCHAR2(13)     NOT NULL, 
    GOOD_CNT     NUMBER(1, 0)     DEFAULT 0 NOT NULL, 
    BAD_CNT      NUMBER(1, 0)     DEFAULT 0 NOT NULL, 
    CRT_TM       DATE             DEFAULT SYSDATE,
    UP_TM        DATE             DEFAULT SYSDATE, 
     PRIMARY KEY (POINT_NUM)
);


CREATE SEQUENCE TB_ROLE_SEQ START WITH 1
INCREMENT BY 1;

CREATE SEQUENCE TB_BOARD_SEQ START WITH 1
INCREMENT BY 1;

CREATE SEQUENCE TB_REPLY_SEQ START WITH 1
INCREMENT BY 1;

CREATE SEQUENCE TB_POINT_SEQ START WITH 1
INCREMENT BY 1;

CREATE UNIQUE INDEX UQ_TB_CATEGORY_1
    ON TB_CATEGORY(CAT);

CREATE INDEX IX_TB_CATEGORY_1
    ON TB_CATEGORY(CAT_DOMAIN, CAT, MNG);


CREATE INDEX IX_TB_MB_1
    ON TB_MB(ID, NM, ALS);

CREATE INDEX IX_TB_BOARD_1
    ON TB_BOARD(BOARD_NUM, CAT_DOMAIN, CREATOR);

CREATE INDEX IX_TB_REPLY_1
    ON TB_REPLY(RPL_NUM, BOARD_NUM, ID);

ALTER TABLE TB_BOARD
    ADD CONSTRAINT FK_TB_BOARD_CAT_DOMAIN FOREIGN KEY (CAT_DOMAIN)
        REFERENCES TB_CATEGORY (CAT_DOMAIN) ON DELETE CASCADE;

ALTER TABLE TB_REPLY
    ADD CONSTRAINT FK_TB_REPLY_BOARD_NUM FOREIGN KEY (BOARD_NUM)
        REFERENCES TB_BOARD (BOARD_NUM) ON DELETE CASCADE;

ALTER TABLE MP_MB_ROLE
    ADD CONSTRAINT FK_MP_MB_ROLE_ID FOREIGN KEY (ID)
        REFERENCES TB_MB (ID) ;

ALTER TABLE MP_MB_ROLE
    ADD CONSTRAINT FK_MP_MB_ROLE_CAT_DOMAIN FOREIGN KEY (CAT_DOMAIN)
        REFERENCES TB_CATEGORY (CAT_DOMAIN) ;

ALTER TABLE MP_MB_ROLE
    ADD CONSTRAINT FK_MP_MB_ROLE_ROLE_NUM FOREIGN KEY (ROLE_NUM)
        REFERENCES TB_ROLE (ROLE_NUM) ;

ALTER TABLE TB_POINT
    ADD CONSTRAINT FK_TB_POINT_BOARD_NUM FOREIGN KEY (BOARD_NUM)
        REFERENCES TB_BOARD(BOARD_NUM) ;

INSERT INTO
TB_ROLE
(ROLE_NUM
,ROLE)
VALUES
(
1,
'BLOCK'
);

INSERT INTO
TB_ROLE
(ROLE_NUM
,ROLE)
VALUES
(
2,
'BASIC'
);

INSERT INTO
TB_ROLE
(ROLE_NUM
,ROLE)
VALUES
(
3,
'SUB_MNG'
);

INSERT INTO
TB_ROLE
(ROLE_NUM
,ROLE)
VALUES
(
4,
'MNG'
);

INSERT INTO
TB_ROLE
(ROLE_NUM
,ROLE)
VALUES
(
5,
'ADMIN'
);